<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>è‚¡ç¥¨è®°å½• - åæ€å®çš„ä¸ªäººä¸»é¡µ</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="site-header">
    <div class="container nav-container">
      <div class="logo">æˆ‘çš„ä¸ªäººæ©±çª—</div>
      <nav class="nav">
        <a href="#home">é¦–é¡µ</a>
      </nav>
      <button class="nav-toggle" aria-label="åˆ‡æ¢å¯¼èˆª">
        <span></span>
        <span></span>
      </button>
    </div>
  </header>

  <main>
    <section id="home" class="hero">
      <div class="container hero-content">
        <div class="hero-text">
          <!-- 1. è‰ºæœ¯åå­—æ ‡é¢˜ -->
          <h1 class="hero-title-with-img">
            ä½ å¥½ï¼Œæˆ‘æ˜¯<img src="me-name.png" alt="åæ€å®" class="name-as-image" />
          </h1>

          <!-- 2. å‡çº§åçš„æ—¶é’Ÿä»ªè¡¨ç›˜è£…é¥° -->
          <div class="clock-dashboard">
            <div class="clock-label">åŒ—äº¬æ—¶é—´</div>
            <div class="clock-date" id="clockDate">0000.00.00 æ˜ŸæœŸä¸€</div>
            <div class="beijing-clock" id="beijingClock">00:00:00</div>
          </div>
          
          <!-- 3. å±…ä¸­çš„ä¸ªäººå¤§å›¾ -->
          <div class="hero-avatar">
            <img src="1767246246813.jpg" alt="åæ€å®" class="avatar-image" />
          </div>

          <!-- 4. è‚¡ç¥¨ç»„ä»¶ -->
          <div class="stocks-container" id="stocksContainer">
            <div class="stock-loading">æ­£åœ¨è·å–è¡Œæƒ…...</div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container footer-content">
      <!-- åº•éƒ¨ä¿æŒæ¸…çˆ½ -->
    </div>
  </footer>

  <script>
    // --- å¯¼èˆªåˆ‡æ¢é€»è¾‘ ---
    const navToggle = document.querySelector('.nav-toggle');
    const nav = document.querySelector('.nav');
    navToggle.addEventListener('click', () => {
      nav.classList.toggle('nav-open');
      navToggle.classList.toggle('nav-toggle-open');
    });

    // --- åŒ—äº¬æ—¶é—´ä»ªè¡¨ç›˜é€»è¾‘ ---
    function updateClock() {
      const clockElement = document.getElementById('beijingClock');
      const dateElement = document.getElementById('clockDate');
      const now = new Date();
      
      // ä½¿ç”¨ Intl API è·å–åŒ—äº¬æ—¶é—´
      const options = {
        timeZone: 'Asia/Shanghai',
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        weekday: 'long',
        hour12: false
      };
      
      const formatter = new Intl.DateTimeFormat('zh-CN', options);
      const parts = formatter.formatToParts(now);
      const val = (type) => parts.find(p => p.type === type).value;

      // ç»„è£…æ—¥æœŸæ ¼å¼ï¼šXXXX.XX.XX æ˜ŸæœŸå‡ 
      const dateStr = `${val('year')}.${val('month')}.${val('day')} ${val('weekday')}`;
      // ç»„è£…æ—¶é—´æ ¼å¼ï¼š00:00:00
      const timeStr = `${val('hour')}:${val('minute')}:${val('second')}`;

      dateElement.textContent = dateStr;
      clockElement.textContent = timeStr;
    }
    setInterval(updateClock, 1000);
    updateClock();

    // --- è‚¡ç¥¨æ•°æ®é€»è¾‘ ---
    const STOCKS = [
      { code: 'sz159898', name: '159898 åŒ»ç–—å™¨æ¢°ETF' },
      { code: 'sh601288', name: 'å†œä¸šé“¶è¡Œ' },
      { code: 'sh601919', name: 'ä¸­è¿œæµ·æ§' },
      { code: 'sh512690', name: 'é…’ETF' },
      { code: 'sh513050', name: '513050 ä¸­æ¦‚äº’è”ETF' },
      { code: 'sz159567', name: '159567 æ¸¯è‚¡åˆ›æ–°è¯ETF' }
    ];
    
    function fetchStockData(stockCode) {
      return new Promise((resolve) => {
        const varName = `v_${stockCode}`;
        const script = document.createElement('script');
        script.charset = 'gb2312';
        script.src = `https://qt.gtimg.cn/q=${stockCode}`;
        script.onload = () => {
          setTimeout(() => {
            try {
              const globalVar = window[varName];
              if (globalVar) {
                const data = globalVar.split('~');
                if (data.length > 3) {
                  const stockConfig = STOCKS.find(s => s.code === stockCode);
                  const name = stockConfig ? stockConfig.name : data[1];
                  const price = parseFloat(data[3]) > 0 ? parseFloat(data[3]) : parseFloat(data[4]);
                  const change = price - parseFloat(data[4]);
                  const percent = parseFloat(data[4]) > 0 ? ((change / parseFloat(data[4])) * 100).toFixed(2) : '0.00';
                  resolve({
                    name, price: price.toFixed(3), change: change.toFixed(3),
                    percent, isUp: change >= 0,
                    open: parseFloat(data[5]).toFixed(2), high: parseFloat(data[33]).toFixed(2), low: parseFloat(data[34]).toFixed(2)
                  });
                  return;
                }
              }
            } catch (e) { }
            script.remove(); resolve(null);
          }, 100);
        };
        script.onerror = () => { script.remove(); resolve(null); };
        document.head.appendChild(script);
      });
    }
    
    async function fetchStocks() {
      const container = document.getElementById('stocksContainer');
      const results = await Promise.all(STOCKS.map(s => fetchStockData(s.code)));
      let html = '';
      results.forEach(data => {
        if (data) {
          const colorClass = data.isUp ? 'stock-up' : 'stock-down';
          const sign = data.isUp ? '+' : '';
          html += `<div class="stock-widget">
            <div class="stock-name-row"><span class="stock-name">ğŸ“ˆ ${data.name}</span></div>
            <div class="stock-info">
              <span class="stock-price ${colorClass}">${data.price}</span>
              <span class="stock-change ${colorClass}">${sign}${data.change} (${sign}${data.percent}%)</span>
              <span class="stock-detail">ä»Šå¼€${data.open} | é«˜${data.high} | ä½${data.low}</span>
            </div>
          </div>`;
        }
      });
      container.innerHTML = html;
    }

    fetchStocks();
    setInterval(fetchStocks, 10000); 
  </script>
</body>
</html>